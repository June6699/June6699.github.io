{% comment %}
  左侧标签导航。可选变量：tag_tree_active_index、tag_tree_is_post
{% endcomment %}
<aside class="col-lg-3 col-md-4 tag-tree-wrap">
	<nav class="tag-tree-card" id="tag-tree">
		<div class="tag-tree-title">
			标签导航
			<span class="nav-toggle">
				<a href="javascript:void(0)" class="nav-toggle-btn" data-action="collapse" title="一键折叠">折叠</a>
				<a href="javascript:void(0)" class="nav-toggle-btn" data-action="expand" title="一键展开">展开</a>
			</span>
		</div>
		<div class="tag-tree-inner">
			{% assign article_pages = site.posts %}
			{% for tag_name in site.tag_list %}
				{% assign count = 0 %}
				{% for a in article_pages %}
					{% if a.tags contains tag_name %}{% assign count = count | plus: 1 %}{% endif %}
				{% endfor %}
				{% assign is_active = false %}
				{% if tag_tree_active_index and forloop.index == tag_tree_active_index %}{% assign is_active = true %}{% endif %}
				<div class="tag-tree-node tag-tree-node-flat {% if is_active %}open tag-tree-node-active{% endif %}" data-target="tag-{{ forloop.index }}">
					{% if tag_tree_is_post %}
					<a href="{{ site.baseurl }}/tags/#tag-{{ forloop.index }}" class="tag-tree-tag" title="{{ tag_name }}">{{ tag_name }} ({{ count }})</a>
					{% else %}
					<a href="#tag-{{ forloop.index }}" class="tag-tree-tag" title="{{ tag_name }}">{{ tag_name }} ({{ count }})</a>
					{% endif %}
					<div class="tag-tree-posts">
						{% for a in article_pages %}
							{% if a.tags contains tag_name %}
							<a href="{{ a.url | prepend: site.baseurl }}" class="tag-tree-post">{{ a.title }}</a>
							{% endif %}
						{% endfor %}
					</div>
				</div>
			{% endfor %}
		</div>
	</nav>
</aside>
